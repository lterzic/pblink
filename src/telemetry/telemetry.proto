syntax = "proto3";
package mp.pb.telemetry;

import "telemetry/channel.proto";

// Sent on start or on request with information
// about available channels, frequencies, ...
message Broadcast {
    // Number of producers for each channel
    message ChannelSources {
        uint32 channel = 1;
        uint32 sources = 2;
    }
    
    // List of available channel payload tags and the number of sources
    // TODO: Can be replaced with map<uint32, uint32> channels = 1;
    repeated ChannelSources channels = 1;
}

// Request a channel from a specific producer
message Subscribe {
    uint32 channel = 1;
    uint32 source = 2;
    // Add frequency (rate)
}

// One or more channels with additional metadata like timestamp, ...
message Telemetry {
    // System uptime in milliseconds
    uint32 timestamp_ms = 1;
    // In case of additional metadata like
    // telemetry specific message id, ...
    reserved 2 to 8;

    // All channels which were ready for sending at
    // the time of creating this message
    repeated Channel channels = 9;
}
